;** $VER: select.gadget_install 40.1 (25.5.98) by Massimo Tantignone
;**

;******************************
;** MESSAGES (DEFAULT: ENGLISH)

(set msg_what   "What do you want to install?")
(set msg_doc    "Documentation")
(set msg_inc    "Include files")
(set msg_fd     "Library .fd file")
(set msg_seldr  "Select the destination drawer:")
(set msg_whgadg "Where do you want to copy the \"select.gadget\" library?")
(set msg_whdoc  "Where do you want to copy the documentation files?")
(set msg_whinc  "Where do you want to copy the include files?\nYou should choose an already existing \"include\" directory.")
(set msg_whfd   "Where do you want to copy the library .fd file?")
;(set msg_cpu000 "68000")
;(set msg_cpu020 "68020/030")
;(set msg_cpu040 "68040")
;(set msg_cpu060 "68060")
(set whathelp   "Choose which part(s) of the select.gadget package are to be installed.")
(set dirhelp    "Select the drawer into which the \"select.gadget\" library is to be copied.\nThe default is \"SYS:Classes/Gadgets\".\nIf a newer version is already in place, it won't be overwritten.")
(set dirhelp2   "Select the drawer into which the documentation is to be copied.")
(set dirhelp3   "Select the directory into which the include files are to be copied.\nThe include directory itself won't be copied to the destination directory; only its contents will.\nThis means that you should choose an already existing \"include\" directory.")
(set dirhelp4   "Select the drawer into which the library .fd file is to be copied.")
;(set cpuhelp    "If you have an accelerated Amiga, you can choose to\ninstall a more optimized version of select.gadget.")
(set msg_done   "For any question or bug report, please write to:\n\ntanti@intercom.it")

;*******************************
;** ASK INSTALLATION PREFERENCES

(complete 5)

(set var_what
   (askoptions
      (prompt msg_what)
      (help whathelp)
      (choices "select.gadget" msg_doc msg_inc msg_fd)
      (default 1)
   )
)

(complete 10)

;(set var_cpu
;   (askchoice
;      (prompt msg_selcpu)
;      (help cpuhelp)
;      (choices msg_cpu000 msg_cpu020 msg_cpu040 msg_cpu060)
;   )
;))

(if (bitand var_what 1)(
   (set gadgdir
      (askdir
         (default "SYS:Classes/Gadgets")
         (help dirhelp)
         (prompt (cat msg_whgadg "\n\n" msg_seldr))
      )
   )
   (set gadgdir (tackon gadgdir ""))
))

(complete 20)

(if (bitand var_what 2)(
   (set docdir
      (askdir
         (default @default-dest)
         (help dirhelp2)
         (prompt (cat msg_whdoc "\n\n" msg_seldr))
      )
   )
   (set docdir (tackon docdir ""))
))

(complete 30)

(if (bitand var_what 4)(
   (set incdir
      (askdir
         (default @default-dest)
         (help dirhelp3)
         (prompt (cat msg_whinc "\n\n" msg_seldr))
      )
   )
   (set incdir (tackon incdir ""))
))

(complete 40)

(if (bitand var_what 8)(
   (set fddir
      (askdir
         (default @default-dest)
         (help dirhelp4)
         (prompt (cat msg_whfd "\n\n" msg_seldr))
      )
   )
   (set fddir (tackon fddir ""))
))

(if (bitand var_what 1)
   (
      (set @default-dest gadgdir)
   )
   (
      (set @default-dest "RAM:")
   )
)

;***************************************
;** INSTALL FILES: SELECT.GADGET LIBRARY

(complete 50)

(if (bitand var_what 1)
   (if (= 0 (exists (tackon gadgdir "select.gadget")))
      (copyfiles
         (source "Classes/Gadgets/select.gadget")
         (dest gadgdir)
      )
      (copylib
         (source "Classes/Gadgets/select.gadget")
         (dest gadgdir)
         (optional nofail)
      )
   )
)

;*******************************
;** INSTALL FILES: DOCUMENTATION

(complete 60)

(if (bitand var_what 2)
   (copyfiles
      (source "")
      (choices "select.doc"
               "select.doc.info"
               "select.guide"
               "select.guide.info"
               "ReadMe.user"
               "ReadMe.user.info")
      (dest docdir)
   )
)

;*******************************
;** INSTALL FILES: INCLUDE FILES

(complete 70)

(if (bitand var_what 4)
   (copyfiles
      (source "include")
      (dest incdir)
      (all)
   )
)

;**************************
;** INSTALL FILES: .FD FILE

(complete 80)

(if (bitand var_what 8)
   (copyfiles
      (source "selectgadget_cl.fd")
      (dest fddir)
   )
)

;**********************************
;** INSTALL FILES: PREFERENCES FILE

(complete 90)

(if (= 0 (exists "ENVARC:Gadgets/select.prefs" (noreq)))(
   (copyfiles
      (source "Env-Archive/Gadgets/select.prefs")
      (dest "ENVARC:Gadgets")
   )
   (copyfiles
      (source "Env-Archive/Gadgets/select.prefs")
      (dest "ENV:Gadgets")
   )
))

(run "Avail FLUSH > NIL:")

;***********
;** READ ME!

(complete 90)

(run "SYS:Utilities/MultiView \"ReadMe.user\"" (safe))

;*******
;** DONE

(complete 100)

(exit (cat "\n" msg_done))

